- id: '1639928034409'
  alias: Weihnachtsbeleuchtung
  description: ''
  triggers:
  - event: sunset
    id: EIN_Zeit
    trigger: sun
  - at: '23:00:00'
    id: AUS_Zeit
    trigger: time
  - trigger: time
    at: 06:00:00
    id: EIN_Zeit
  - trigger: sun
    event: sunrise
    offset: 00:30:00
    id: AUS_Zeit
  conditions:
  - condition: state
    entity_id: input_boolean.weihnachtsbeleuchtung_verfugbar
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: EIN_Zeit
      sequence:
      - action: light.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: light.weihnachtsbeleuchtung
    - conditions:
      - condition: trigger
        id: AUS_Zeit
      sequence:
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.weihnachtsbeleuchtung
    default: []
  mode: single
- id: '1639979694151'
  alias: Open - All
  description: ''
  trigger:
  - platform: sun
    event: sunrise
    offset: '0'
  condition:
  - condition: numeric_state
    entity_id: sensor.temp_aussen_low
    above: '-1'
  action:
  - service: cover.open_cover
    target:
      label_id: rollladen_automation
    data: {}
  mode: single
- id: '1641065185674'
  alias: Close - UG - Technikraum
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.fenster_technikraum
    to: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 5
  - platform: sun
    event: sunset
    offset: '1200'
  condition:
  - condition: sun
    after: sunset
    after_offset: '1200'
  - condition: state
    entity_id: binary_sensor.fenster_technikraum
    state: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 5
  action:
  - service: cover.close_cover
    data: {}
    target:
      entity_id: cover.technikraum_low_speed
  mode: single
- id: '1641065185675'
  alias: Close - UG - Hobbyraum Süd
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.fenster_hobbyraum_sud
    to: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 5
  - platform: sun
    event: sunset
    offset: '1200'
  condition:
  - condition: sun
    after: sunset
    after_offset: '1200'
  - condition: state
    entity_id: binary_sensor.fenster_hobbyraum_sud
    state: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 5
  action:
  - service: cover.close_cover
    data: {}
    target:
      entity_id: cover.hobby_sud_low_speed
  mode: single
- id: '1641065185676'
  alias: Close - UG - Balkontür
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.terassentur
    to: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 5
  - platform: sun
    event: sunset
    offset: '1300'
  condition:
  - condition: sun
    after: sunset
    after_offset: '1300'
  - condition: state
    entity_id: binary_sensor.terassentur
    state: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 5
  action:
  - service: cover.close_cover
    data: {}
    target:
      entity_id: cover.balkontur_low_speed
  mode: single
- id: '1641065185677'
  alias: Close - UG - Hobbyraum West
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.fenster_hobbyraum_west
    to: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 5
  - platform: sun
    event: sunset
    offset: '1200'
  condition:
  - condition: sun
    after: sunset
    after_offset: '1200'
  - condition: state
    entity_id: binary_sensor.fenster_hobbyraum_west
    state: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 5
  action:
  - service: cover.close_cover
    data: {}
    target:
      entity_id: cover.hobby_west_low_speed
  mode: single
- id: '1641065185678'
  alias: Close - EG - WC
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.fenster_bad_eg
    to: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 5
  - platform: sun
    event: sunset
    offset: '1200'
  condition:
  - condition: sun
    after: sunset
    after_offset: '1200'
  - condition: state
    entity_id: binary_sensor.fenster_bad_eg
    state: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 5
  action:
  - service: cover.close_cover
    data: {}
    target:
      entity_id: cover.bad_eg_low_speed
  mode: single
- id: '1641320769609'
  alias: Close - OG - Hausgang
  description: ''
  trigger:
  - platform: sun
    event: sunset
    offset: '1200'
  condition: []
  action:
  - service: cover.close_cover
    data: {}
    target:
      entity_id: cover.hausgang_og_low_speed
  mode: single
- id: '1641320877843'
  alias: Open - UG - Balkontür
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.terassentur
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 1
    from: 'off'
  condition: []
  action:
  - service: cover.open_cover
    data: {}
    target:
      entity_id: cover.balkontur
  mode: single
- id: '1643808353305'
  alias: Close - EG - Buro
  description: ''
  triggers:
  - entity_id:
    - binary_sensor.fenster_buro_eg
    to: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 5
    trigger: state
  - event: sunset
    offset: '1800'
    trigger: sun
  conditions:
  - condition: sun
    after: sunset
    after_offset: '1200'
  - condition: state
    entity_id: binary_sensor.fenster_buro_eg
    state: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 5
  actions:
  - data: {}
    target:
      entity_id: cover.buro
    action: cover.close_cover
  mode: single
- id: '1718780262317'
  alias: Monitoring - Gefrierschrank Prevent from OFF
  description: ''
  triggers:
  - seconds: '30'
    trigger: time_pattern
  conditions:
  - condition: device
    type: is_off
    device_id: fdb7d62111ba59cfeadd758cd1ea4b35
    entity_id: 0cd9d297a3128c925fcc0be941e3c3a4
    domain: switch
  actions:
  - type: turn_on
    device_id: fdb7d62111ba59cfeadd758cd1ea4b35
    entity_id: 0cd9d297a3128c925fcc0be941e3c3a4
    domain: switch
  - action: notify.notification_group_all_devices
    metadata: {}
    data:
      message: Gefrierschrank musste wieder eingeschaltet werden!
  mode: parallel
  max: 10
- id: '1719771764641'
  alias: EnergySave - Smart Mirror
  description: ''
  triggers:
  - at: 06:00:00
    id: Ein
    trigger: time
  - at: '22:00:00'
    id: Aus
    trigger: time
  conditions:
  - condition: state
    entity_id: input_boolean.urlaubsmodus
    state: 'off'
  actions:
  - if:
    - condition: trigger
      id:
      - Ein
    then:
    - metadata: {}
      data: {}
      target:
        entity_id:
        - switch.mb_power_smartmirror
        - switch.usw_main_smartmirror_poe
      action: switch.turn_on
  - if:
    - condition: trigger
      id:
      - Aus
    then:
    - target:
        entity_id:
        - switch.mb_power_smartmirror
        - switch.usw_main_smartmirror_poe
      data: {}
      action: switch.turn_off
  mode: single
- id: '1722603963360'
  alias: WGT - Set Fan Level Dropdown
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.aktuelle_luftstufe_wgt
  condition: []
  action:
  - if:
    - condition: numeric_state
      entity_id: sensor.aktuelle_luftstufe_wgt
      below: 1
    then:
    - service: input_select.select_option
      metadata: {}
      data:
        option: Aus
      target:
        entity_id: input_select.wgt_fanlevel
  - if:
    - condition: numeric_state
      entity_id: sensor.aktuelle_luftstufe_wgt
      above: 2
      below: 4
    then:
    - service: input_select.select_option
      metadata: {}
      data:
        option: Stufe 3
      target:
        entity_id: input_select.wgt_fanlevel
  - if:
    - condition: numeric_state
      entity_id: sensor.aktuelle_luftstufe_wgt
      above: 3
    then:
    - service: input_select.select_option
      metadata: {}
      data:
        option: Stufe 4
      target:
        entity_id: input_select.wgt_fanlevel
  - if:
    - condition: numeric_state
      entity_id: sensor.aktuelle_luftstufe_wgt
      below: 2
      above: 0
    then:
    - service: input_select.select_option
      metadata: {}
      data:
        option: Stufe 1
      target:
        entity_id: input_select.wgt_fanlevel
  - if:
    - condition: numeric_state
      entity_id: sensor.aktuelle_luftstufe_wgt
      below: 3
      above: 1
    then:
    - service: input_select.select_option
      metadata: {}
      data:
        option: Stufe 2
      target:
        entity_id: input_select.wgt_fanlevel
  mode: single
- id: '1722606836815'
  alias: WGT - Set Climate Mode from WGT
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.betriebsart_wgt
    for:
      hours: 0
      minutes: 0
      seconds: 1
  condition:
  - condition: and
    conditions:
    - condition: not
      conditions:
      - condition: state
        entity_id: climate.wgtmode_template
        state: cool
      enabled: false
    - condition: template
      value_template: '{{ (states(''sensor.betriebsart_wgt'') == ''0'' and states(''climate.wgtmode_template'')
        != ''off'' ) or (states(''sensor.betriebsart_wgt'') == ''2'' and states(''climate.wgtmode_template'')
        != ''heat'' ) or


        (states(''sensor.betriebsart_wgt'') == ''3'' and ( (states(''climate.wgtmode_template'')
        != ''fan_only'' and states(''climate.wgtmode_template'') == ''cool'') or (states(''climate.wgtmode_template'')
        == ''fan_only'' and states(''climate.wgtmode_template'') != ''cool'')  ))
        or


        (states(''sensor.betriebsart_wgt'') == ''4'' and states(''climate.wgtmode_template'')
        != ''auto'' )  }}'
  action:
  - if:
    - condition: numeric_state
      entity_id: sensor.betriebsart_wgt
      below: 1
    then:
    - service: climate.set_hvac_mode
      metadata: {}
      data:
        hvac_mode: 'off'
      target:
        entity_id: climate.wgtmode_template
  - if:
    - condition: numeric_state
      entity_id: sensor.betriebsart_wgt
      below: 4
      above: 2
    then:
    - service: climate.set_hvac_mode
      metadata: {}
      data:
        hvac_mode: fan_only
      target:
        entity_id: climate.wgtmode_template
  - if:
    - condition: numeric_state
      entity_id: sensor.betriebsart_wgt
      below: 3
      above: 1
    then:
    - service: climate.set_hvac_mode
      metadata: {}
      data:
        hvac_mode: heat
      target:
        entity_id: climate.wgtmode_template
  - if:
    - condition: numeric_state
      entity_id: sensor.betriebsart_wgt
      above: 3
    then:
    - service: climate.set_hvac_mode
      metadata: {}
      data:
        hvac_mode: auto
      target:
        entity_id: climate.wgtmode_template
  mode: single
- id: '1733170085023'
  alias: Monitoring - Kühlschrank Prevent from OFF
  description: ''
  triggers:
  - seconds: '30'
    trigger: time_pattern
  conditions:
  - condition: device
    type: is_off
    device_id: bc2325c10edce6d5480fca12778e70e4
    entity_id: 9864ad8023597e71d21b0dfb0ca31ed4
    domain: switch
  actions:
  - type: turn_on
    device_id: bc2325c10edce6d5480fca12778e70e4
    entity_id: 9864ad8023597e71d21b0dfb0ca31ed4
    domain: switch
  - action: notify.notification_group_all_devices
    metadata: {}
    data:
      message: Kühlschrank musste wieder eingeschaltet werden!
  mode: parallel
  max: 10
- id: '1735476152143'
  alias: Monitoring - Waschmaschine
  description: Monitoring der Waschmaschine
  use_blueprint:
    path: leofabri/appliance-status-monitor.yaml
    input:
      automation_self_trigger: input_boolean.waschmaschine_automation_self_trigger
      appliance_socket: switch.shelly_em_wasch
      appliance_power_sensor: sensor.waschmaschine_power
      appliance_finishing_power_threshold: 1
      appliance_starting_power_threshold: 30
      actions_job_cycle_ends:
      - action: notify.notification_group_all_devices
        metadata: {}
        data:
          message: Waschmaschine ist fertig.
      delayed_job_completion_duration: 301
      actions_new_job_cycle_begins: []
      delayed_job_completion_timer: timer.waschmaschine_delayed_job_completion_timer
      appliance_job_cycle: input_boolean.waschmaschine_job_cycle
      appliance_state_machine: input_select.waschmaschine_state_machine
- id: '1735744081129'
  alias: Monitoring - Spülmaschine
  description: ''
  use_blueprint:
    path: leofabri/appliance-status-monitor.yaml
    input:
      automation_self_trigger: input_boolean.spulmschine_automation_self_trigger
      appliance_socket: switch.std_spulmaschine
      appliance_power_sensor: sensor.std_spulmaschine_leistung_2
      appliance_starting_power_threshold: 10
      appliance_state_machine: input_select.spulmaschine_state_machine
      appliance_job_cycle: input_boolean.spulmaschine_job_cycle
      delayed_job_completion_timer: timer.spulmschine_delayed_job_completion_timer
      delayed_job_completion_duration: 60
      actions_job_cycle_ends:
      - action: notify.notification_group_all_devices
        metadata: {}
        data:
          message: Spülmaschine ist fertig.
- id: '1741591278307'
  alias: Monitoring - Wetterwarnung - Regen
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.ads_wetterrain
    from: 'off'
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 5
  conditions:
  - condition: template
    value_template: '{{ now() - state_attr(''automation.meldung_regen'', ''last_triggered'')
      > timedelta(minutes=15) }}'
  actions:
  - action: notify.notification_group_all_devices
    metadata: {}
    data:
      message: Es beginnt zu regnen.
      title: WETTERWARNUNG
  mode: single
- id: '1741598129274'
  alias: Monitoring - Wetterwarnung - Windböen
  description: ''
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.ads_wetterwindspeed
    above: 70
  conditions:
  - condition: or
    conditions:
    - condition: numeric_state
      entity_id: cover.jalousie_esszimmer
      attribute: current_position
      below: 100
    - condition: numeric_state
      entity_id: cover.wohnzimmer_jalousie
      attribute: current_position
      below: 100
  - condition: numeric_state
    entity_id: sensor.ads_wetterwinddir
    above: 170
  actions:
  - action: notify.notification_group_all_devices
    metadata: {}
    data:
      message: Windböen über 70 km/h gemessen. Jalousien fahren hoch!
      title: WETTERWARNUNG
  - action: cover.open_cover
    metadata: {}
    data: {}
    target:
      entity_id:
      - cover.jalousie_esszimmer
      - cover.wohnzimmer_jalousie
  mode: single
- id: '1742067131896'
  alias: SET - DateTime LetzterNiederschlag
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - sensor.ads_wetterrain
  conditions: []
  actions:
  - target:
      entity_id: input_datetime.letzterniederschlag
    data:
      timestamp: '{{ now().timestamp() }}'
    action: input_datetime.set_datetime
  mode: single
- id: '1743429970101'
  alias: Voice - Radiosteuerung
  description: ''
  triggers:
  - trigger: conversation
    command:
    - Spiele SWR 1
    - Radio an
    - Radio anschalten
    - Radio einschalten
    id: SWR1
  - trigger: conversation
    command:
    - Radio aus
    - Musik aus
    - Musik ausschalten
    - 'Radio ausschalten '
    id: Radio Aus
  conditions: []
  actions:
  - if:
    - condition: trigger
      id:
      - SWR1
    then:
    - action: music_assistant.play_media
      metadata: {}
      data:
        media_id: library://radio/1
      target:
        entity_id: media_player.home_assistant_voice_09d11a_media_player_2
    - set_conversation_response: .
  - if:
    - condition: trigger
      id:
      - Radio Aus
    then:
    - action: media_player.media_stop
      metadata: {}
      data: {}
      target:
        entity_id: media_player.home_assistant_voice_09d11a_media_player_2
    - set_conversation_response: .
  mode: single
- id: '1743439871259'
  alias: Voice - Modi
  description: ''
  triggers:
  - trigger: conversation
    command: Guten Morgen
    id: GutenMorgen
  - trigger: conversation
    command:
    - Rollläden schließen
    id: Rollläden Nachtmodus
  - trigger: conversation
    command:
    - Gute Nacht
    id: GuteNacht
  conditions: []
  actions:
  - if:
    - condition: trigger
      id:
      - GutenMorgen
    then:
    - action: script.guten_morgen
      metadata: {}
      data: {}
    - sequence:
      - set_conversation_response: Guten Morgen liebe Familie! Es hat aktuell {{ states('sensor.temp_aussen_low')
          | round }}°C draußen. Ich wünsche einen schönen Tag!
      - action: script.radio_auf_voice_starten
        metadata: {}
        data: {}
  - if:
    - condition: and
      conditions:
      - condition: trigger
        id:
        - Rollläden Nachtmodus
      - condition: state
        entity_id: sun.sun
        state: below_horizon
    then:
    - action: cover.close_cover
      metadata: {}
      data: {}
      target:
        entity_id:
        - cover.esszimmer_sud
        - cover.kuche
        - cover.wohnzimmer_jalousie
    - set_conversation_response: .
  - if:
    - condition: trigger
      id:
      - GuteNacht
    then:
    - action: script.gute_nacht
      metadata: {}
      data: {}
    - sequence:
      - set_conversation_response: Guten Nacht. Schlaf gut!
      - action: media_player.media_pause
        metadata: {}
        data: {}
        target:
          entity_id: media_player.home_assistant_voice_09d11a_media_player_2
  mode: single
- id: '1744315603499'
  alias: EnergySave - 3D Print
  description: ''
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.std_3dprinter_leistung
    for:
      hours: 0
      minutes: 15
      seconds: 0
    below: 30
  conditions:
  - condition: time
    after: '22:00:00'
    before: 08:00:00
  actions:
  - action: switch.turn_off
    metadata: {}
    data: {}
    target:
      device_id: fdc1b7310e457c44af4023a9006bc8a4
  mode: single
- id: '1746252009778'
  alias: Open - BY SUN
  description: ''
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.wetterluxtotal
    above: 100
  conditions:
  - condition: state
    entity_id: sun.sun
    attribute: rising
    state: true
  - condition: state
    entity_id: input_boolean.urlaubsmodus
    state: 'off'
  actions:
  - action: button.press
    metadata: {}
    data: {}
    target:
      entity_id: button.hausgang_og_my_position
  - action: cover.open_cover
    metadata: {}
    data: {}
    target:
      entity_id:
      - cover.bad_og
      - cover.esszimmer_sud_low_speed
      - cover.wohnzimmer_jalousie
      - cover.kuche_low_speed
  - action: switch.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: switch.mb_powersocket_fernseher
  - if:
    - condition: state
      entity_id: binary_sensor.balkontur
      state: 'off'
    then:
    - action: cover.open_cover
      metadata: {}
      data: {}
      target:
        entity_id: cover.jalousie_esszimmer
  mode: single
- id: '1746342563586'
  alias: Open - OG - Hausgang
  description: ''
  triggers:
  - trigger: time
    at: '13:00:00'
  conditions: []
  actions:
  - action: cover.open_cover
    metadata: {}
    data: {}
    target:
      entity_id: cover.hausgang_og_low_speed
  mode: single
- id: '1746376437539'
  alias: Monitoring - ALARM - Wasser Zuhause
  description: ''
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.zisternenentnahme_heute
    above: 0.5
  - trigger: numeric_state
    entity_id:
    - sensor.trinkwasserentnahme_heute
    above: 0.5
    enabled: true
  conditions:
  - condition: state
    entity_id: input_boolean.urlaubsmodus
    state: 'off'
  actions:
  - action: notify.notification_group_all_devices
    metadata: {}
    data:
      message: "Trinkwasser: {{ ((states.sensor.trinkwasserentnahme_heute.state |
        float * 1000)) | round(0) }} Liter \nZisternenwasser: {{ ((states.sensor.zisternenentnahme_heute.state
        | float * 1000)) | round(0) }} Liter"
      title: '!!! WASSERALARM !!!'
  mode: single
- id: '1746381984743'
  alias: Urlaub - ALARM - Wasser Urlaub
  description: ''
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.zisternenentnahme_heute
    above: 0.2
  - trigger: numeric_state
    entity_id:
    - sensor.trinkwasserentnahme_heute
    above: 0.01
    enabled: true
  conditions:
  - condition: state
    entity_id: input_boolean.urlaubsmodus
    state: 'on'
  actions:
  - action: notify.notification_group_all_devices
    metadata: {}
    data:
      message: "Trinkwasser: {{ ((states.sensor.trinkwasserentnahme_heute.state |
        float * 1000)) | round(0) }} Liter \nZisternenwasser: {{ ((states.sensor.zisternenentnahme_heute.state
        | float * 1000)) | round(0) }} Liter"
      title: '!!! WASSERALARM !!!'
  mode: single
- id: '1747503467142'
  alias: EnergySave - Entfeuchter Werkstatt
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.werkstatttur
    to: 'on'
    for:
      hours: 0
      minutes: 10
      seconds: 0
    id: Aus
  - trigger: state
    entity_id:
    - binary_sensor.werkstatttur
    to: 'off'
    for:
      hours: 0
      minutes: 10
      seconds: 0
    id: An
  - trigger: state
    entity_id:
    - input_boolean.entfeuchter_werkstatt
    to: 'off'
    id: Aus
  - trigger: state
    entity_id:
    - input_boolean.entfeuchter_werkstatt
    to: 'on'
    id: Eingeschaltet
  conditions: []
  actions:
  - if:
    - condition: trigger
      id:
      - Aus
    then:
    - action: switch.turn_off
      metadata: {}
      data: {}
      target:
        entity_id: switch.mb_werkstatt_entfeuchter
  - if:
    - condition: and
      conditions:
      - condition: trigger
        id:
        - An
      - condition: numeric_state
        entity_id: sensor.wetterluxtotal
        above: 1000
      - condition: state
        entity_id: input_boolean.entfeuchter_werkstatt
        state: 'on'
    then:
    - action: switch.turn_on
      metadata: {}
      data: {}
      target:
        entity_id: switch.mb_werkstatt_entfeuchter
  - if:
    - condition: trigger
      id:
      - Eingeschaltet
    then:
    - action: switch.turn_on
      metadata: {}
      data: {}
      target:
        entity_id: switch.mb_werkstatt_entfeuchter
  mode: single
- id: '1747548529506'
  alias: Close - OG - Bad
  description: ''
  triggers:
  - event: sunset
    offset: '900'
    trigger: sun
  conditions: []
  actions:
  - data: {}
    action: cover.close_cover
    target:
      entity_id: cover.bad_og_low_speed
  mode: single
- id: '1749362747767'
  alias: Urlaub - Gerätesteuerung Strom
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - input_boolean.urlaubsmodus
    from: 'off'
    to: 'on'
    id: Urlaub Ein
  - trigger: state
    entity_id:
    - input_boolean.urlaubsmodus
    from: 'on'
    to: 'off'
    id: Urlaub Aus
  conditions: []
  actions:
  - alias: Urlaub Ein
    if:
    - condition: trigger
      id:
      - Urlaub Ein
    then:
    - alias: Accesspoints aus
      action: switch.turn_off
      metadata: {}
      data: {}
      target:
        entity_id:
        - switch.usw_main_port_20_poe
        - switch.usw_main_port_23_poe
        - switch.usw_main_port_5_poe
        - switch.usw_office_port_8_poe
    - alias: Steckdosen ausschalten
      action: switch.turn_off
      metadata: {}
      data: {}
      target:
        entity_id:
        - switch.mb_powersocket_fernseher
        - switch.mb_powersocket_uhr
        - switch.mb_powersocket_aussen_haustur
        - switch.mb_powersocket_aussen_balkon
        - switch.mb_power_ladegarage
        - switch.mb_power_ladewerkstatt
        - switch.mb_powersocket_werkstatt
  - alias: Urlaub Aus
    if:
    - condition: trigger
      id:
      - Urlaub Aus
    then:
    - alias: Accesspoints ein
      action: switch.turn_on
      metadata: {}
      data: {}
      target:
        entity_id:
        - switch.usw_main_port_20_poe
        - switch.usw_main_port_23_poe
        - switch.usw_main_port_5_poe
        - switch.usw_office_port_8_poe
    - action: switch.turn_on
      metadata: {}
      data: {}
      target:
        entity_id: switch.mb_powersocket_uhr
      alias: Steckdose einschalten
  mode: single
- id: '1749364384372'
  alias: Urlaub - Gerätesteuerung WGT
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - input_boolean.urlaubsmodus
    from: 'off'
    to: 'on'
    id: Urlaub Ein
  conditions: []
  actions:
  - alias: Urlaub Ein
    if:
    - condition: trigger
      id:
      - Urlaub Ein
    then:
    - action: climate.set_hvac_mode
      metadata: {}
      data:
        hvac_mode: fan_only
      target:
        entity_id: climate.wgtmode_template
  mode: single
- id: '1749365112915'
  alias: Urlaub - Lichtsteuerung
  description: ''
  triggers:
  - trigger: sun
    event: sunset
    offset: 0
    id: Sonnenuntergang
  - trigger: time
    at: '23:00:00'
    id: Ausschalten
  conditions:
  - condition: state
    entity_id: input_boolean.urlaubsmodus
    state: 'on'
  actions:
  - if:
    - condition: trigger
      id:
      - Sonnenuntergang
    then:
    - action: light.turn_on
      metadata: {}
      data:
        brightness_pct: 50
      target:
        entity_id: light.mb_esszimmertisch
    alias: Licht einschalten
  - alias: Licht ausschalten
    if:
    - condition: trigger
      id:
      - Ausschalten
    then:
    - delay: '{{ range(0, 31)|random|multiply(60) }}'
    - action: light.turn_off
      metadata: {}
      data: {}
      target:
        entity_id: light.mb_esszimmertisch
  mode: single
- id: '1749365944823'
  alias: Urlaub - Rollladen Nachtsteuerung
  description: ''
  triggers:
  - trigger: sun
    event: sunset
    offset: 00:43:00
    id: Sonnenuntergang
  - trigger: sun
    event: sunrise
    offset: 00:30:00
    id: Sonnenaufgang
  conditions:
  - condition: state
    entity_id: input_boolean.urlaubsmodus
    state: 'on'
  actions:
  - alias: Rollladen zu
    if:
    - condition: trigger
      id:
      - Sonnenuntergang
    then:
    - action: cover.close_cover
      metadata: {}
      data: {}
      target:
        entity_id:
        - cover.schlafzimmer
        - cover.erik_nord
        - cover.erik_west
        - cover.linus_west
        - cover.linus_sud_custom
        - cover.kuche
        - cover.esszimmer_sud
        - cover.wohnzimmer_jalousie
  - alias: Rollladen auf
    if:
    - condition: trigger
      id:
      - Sonnenaufgang
    then:
    - action: cover.open_cover
      metadata: {}
      data: {}
      target:
        entity_id:
        - cover.schlafzimmer
        - cover.erik_nord
        - cover.erik_west
        - cover.linus_west
        - cover.linus_sud_custom
        - cover.kuche
        - cover.esszimmer_sud
        - cover.wohnzimmer_jalousie
  mode: single
- id: '1749367056107'
  alias: Urlaub - ALARM - Öffnungsalarm
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.hue_secure_contact_sensor_1_offnet
    - binary_sensor.werkstatttur
    - binary_sensor.tur_garage_haus
    - binary_sensor.tur_garage_strasse
    - binary_sensor.fenster_garage
    - binary_sensor.fenster_keller
    - binary_sensor.fenster_technikraum
    - binary_sensor.fenster_werkstatt
    - binary_sensor.fenster_bad_eg
    - binary_sensor.fenster_buro_eg
    - binary_sensor.fenster_hobbyraum_sud
    - binary_sensor.fenster_hobbyraum_west
    from: 'off'
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 1
  conditions:
  - condition: state
    entity_id: input_boolean.urlaubsmodus
    state: 'on'
    enabled: true
  actions:
  - action: notify.notification_group_all_devices
    metadata: {}
    data:
      message: Eine Tür oder ein Fenster wurde geöffnet!
      title: '!!! Öffnungsalarm !!!'
  mode: single
- id: '1749890412696'
  alias: WGT - Sommersteuerung
  description: ''
  triggers:
  - trigger: time_pattern
    minutes: /15
  conditions:
  - condition: state
    entity_id: input_boolean.sommersteuerung_luftung
    state: 'on'
    alias: Wenn Sommersteuerung aktiv ist
  actions:
  - choose:
    - conditions:
      - condition: template
        value_template: '{{ states(''sensor.temp_aussen_low'') | float | round(0)
          < states(''sensor.temperatur_wohnzimmer'') | float | round(0)}}'
        alias: Wenn aussen KÄLTER
      sequence:
      - action: climate.set_hvac_mode
        metadata: {}
        data:
          hvac_mode: fan_only
        target:
          entity_id: climate.wgtmode_template
        alias: Nur Lüften
    - conditions:
      - condition: and
        conditions:
        - alias: Wenn aussen WÄRMER
          condition: template
          value_template: '{{ states(''sensor.temp_aussen_low'') | float | round(0)
            > states(''sensor.temperatur_wohnzimmer'') | float | round(0)}}'
        - condition: numeric_state
          entity_id: sensor.mb_solaredge_m1_ac_power_final
          above: 500
        - condition: state
          entity_id: input_boolean.urlaubsmodus
          state: 'off'
      sequence:
      - action: climate.set_hvac_mode
        metadata: {}
        data:
          hvac_mode: cool
        target:
          entity_id: climate.wgtmode_template
        alias: Kühlen
      alias: Wenn aussen WÄRMER + PV
    - conditions:
      - alias: Wenn aussen WÄRMER
        condition: template
        value_template: '{{ states(''sensor.temp_aussen_low'') | float | round(0)
          > states(''sensor.temperatur_wohnzimmer'') | float | round(0)}}'
      sequence:
      - action: climate.set_hvac_mode
        metadata: {}
        data:
          hvac_mode: 'off'
        target:
          entity_id: climate.wgtmode_template
        alias: Lüftung ausschalten
  mode: single
- id: '1749996238572'
  alias: EnergySave - Accesspoints
  description: ''
  triggers:
  - trigger: time
    at: 07:00:00
    id: ein
  - trigger: time_pattern
    minutes: /10
    id: aus
  conditions:
  - condition: state
    entity_id: input_boolean.urlaubsmodus
    state: 'off'
  actions:
  - if:
    - condition: trigger
      id:
      - aus
    - condition: sun
      before: sunrise
      after: sunset
      after_offset: 01:00:00
    - condition: state
      entity_id: binary_sensor.terassentur
      state: 'off'
      for:
        hours: 0
        minutes: 10
        seconds: 0
    then:
    - action: switch.turn_off
      data: {}
      target:
        entity_id: switch.usw_main_port_5_poe
      alias: UAP-Garage OFF
    - action: switch.turn_off
      data: {}
      target:
        entity_id: switch.usw_office_port_8_poe
      alias: UAP-Garten OFF
    - action: switch.turn_off
      data: {}
      target:
        entity_id: switch.usw_main_port_20_poe
      alias: UAP-Werkstatt OFF
    else:
    - if:
      - condition: trigger
        id:
        - ein
      then:
      - action: switch.turn_on
        data: {}
        target:
          entity_id: switch.usw_main_port_5_poe
        alias: UAP-Garage ON
      - action: switch.turn_on
        target:
          entity_id:
          - switch.usw_office_port_8_poe
        data: {}
        alias: UAP-Garten ON
      - action: switch.turn_on
        target:
          entity_id:
          - switch.usw_main_port_20_poe
        data: {}
        alias: UAP-Werkstatt ON
  mode: single
- id: '1750792174376'
  alias: Beschattung - EG - Esszimmer Süd
  description: ''
  triggers:
  - trigger: time_pattern
    minutes: /5
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: cover.esszimmer_sud
      state: closed
    alias: Wenn Fenster nicht geschlossen ist
  - condition: state
    entity_id: binary_sensor.beschattung_zeitfenster
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.beschattung_suden_close
        state: 'on'
      sequence:
      - action: button.press
        metadata: {}
        data: {}
        target:
          entity_id: button.esszimmer_sud_my_position
      alias: Beschatten
    - conditions:
      - condition: numeric_state
        entity_id: cover.esszimmer_sud
        attribute: current_position
        above: 0
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.esszimmer_sud_low_speed
      alias: Öffnen
  mode: single
- id: '1750846982773'
  alias: Beschattung - EG - Küche
  description: ''
  triggers:
  - trigger: time_pattern
    minutes: /5
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: cover.kuche
      state: closed
    alias: Wenn Fenster nicht geschlossen ist
  - condition: state
    entity_id: binary_sensor.beschattung_zeitfenster
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.beschattung_suden_close
        state: 'on'
      sequence:
      - action: button.press
        metadata: {}
        data: {}
        target:
          entity_id: button.kuche_my_position
      alias: Beschatten
    - conditions:
      - condition: numeric_state
        entity_id: cover.kuche
        attribute: current_position
        above: 0
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.kuche_low_speed
      alias: Öffnen
  mode: single
- id: '1750848661424'
  alias: Beschattung - OG - Bad
  description: ''
  triggers:
  - trigger: time_pattern
    minutes: /5
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: cover.bad_og
      state: closed
    alias: Wenn Fenster nicht geschlossen ist
  - condition: state
    entity_id: binary_sensor.beschattung_zeitfenster
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.beschattung_suden_close
        state: 'on'
      sequence:
      - action: button.press
        metadata: {}
        data: {}
        target:
          entity_id: button.bad_og_my_position
      alias: Beschatten
    - conditions:
      - condition: numeric_state
        entity_id: cover.bad_og
        attribute: current_position
        above: 0
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.bad_og_low_speed
      alias: Öffnen
  mode: single
- id: '1750848812381'
  alias: Beschattung - OG - LiHe Süd
  description: ''
  triggers:
  - trigger: time_pattern
    minutes: /5
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: cover.linus_sud_custom
      state: closed
    alias: Wenn Fenster nicht geschlossen ist
  - condition: state
    entity_id: binary_sensor.beschattung_zeitfenster
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.beschattung_suden_close
        state: 'on'
      sequence:
      - action: cover.set_cover_position
        metadata: {}
        data:
          position: 58
        target:
          entity_id: cover.linus_sud_custom
      alias: Beschatten
    - conditions:
      - condition: numeric_state
        entity_id: cover.linus_sud_custom
        attribute: current_position
        above: 0
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.linus_sud_custom
      alias: Öffnen
  mode: restart
- id: '1750848963671'
  alias: Beschattung - UG - Technikraum
  description: ''
  triggers:
  - trigger: time_pattern
    minutes: /5
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: cover.technikraum
      state: closed
    alias: Wenn Fenster nicht geschlossen ist
  - condition: state
    entity_id: binary_sensor.beschattung_zeitfenster
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: and
        conditions:
        - condition: state
          entity_id: binary_sensor.fenster_technikraum
          state: 'off'
        - condition: state
          entity_id: binary_sensor.beschattung_suden_close
          state: 'on'
      sequence:
      - action: button.press
        metadata: {}
        data: {}
        target:
          entity_id: button.technikraum_my_position
      alias: Beschatten
    - conditions:
      - condition: numeric_state
        entity_id: cover.technikraum
        attribute: current_position
        above: 0
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.technikraum_low_speed
      alias: Öffnen
  mode: single
- id: '1750850796546'
  alias: Beschattung - UG - Hobby Süd
  description: ''
  triggers:
  - trigger: time_pattern
    minutes: /5
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: cover.hobby_sud
      state: closed
    alias: Wenn Fenster nicht geschlossen ist
  - condition: state
    entity_id: binary_sensor.beschattung_zeitfenster
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: and
        conditions:
        - condition: state
          entity_id: binary_sensor.fenster_hobbyraum_sud
          state: 'off'
        - condition: state
          entity_id: binary_sensor.beschattung_suden_close
          state: 'on'
      sequence:
      - action: button.press
        metadata: {}
        data: {}
        target:
          entity_id: button.hobby_sud_my_position
      alias: Beschatten
    - conditions:
      - condition: numeric_state
        entity_id: cover.hobby_sud
        attribute: current_position
        above: 0
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.hobby_sud_low_speed
      alias: Öffnen
  mode: single
- id: '1750852273564'
  alias: Beschattung - EG - Esszimmer Jalousie
  description: ''
  triggers:
  - trigger: time_pattern
    minutes: /5
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: and
        conditions:
        - condition: state
          entity_id: binary_sensor.balkontur
          state: 'off'
        - condition: state
          entity_id: binary_sensor.beschattung_westen_close
          state: 'on'
        - condition: state
          entity_id: binary_sensor.beschattung_zeitfenster
          state: 'on'
      sequence:
      - action: button.press
        metadata: {}
        data: {}
        target:
          entity_id: button.esszimmer_jalousie_my_position
      alias: Beschatten
    - conditions:
      - condition: numeric_state
        entity_id: cover.jalousie_esszimmer
        attribute: current_tilt_position
        above: 0
      - condition: state
        entity_id: binary_sensor.beschattung_zeitfenster
        state: 'on'
      - condition: state
        entity_id: binary_sensor.beschattung_westen_close
        state: 'off'
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.jalousie_esszimmer
      alias: Öffnen Beschattung
    - conditions:
      - condition: state
        entity_id: binary_sensor.beschattung_zeitfenster
        state: 'off'
        for:
          hours: 0
          minutes: 1
          seconds: 0
      - condition: state
        entity_id: cover.jalousie_esszimmer
        state: closed
      - condition: numeric_state
        entity_id: cover.jalousie_esszimmer
        attribute: current_tilt_position
        above: 0
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.jalousie_esszimmer
      alias: Öffnen wenn Beschattung vorbei
  mode: restart
- id: '1750856088782'
  alias: Beschattung - EG - Wohnzimmer Jalousie
  description: ''
  triggers:
  - trigger: time_pattern
    minutes: /5
  conditions:
  - condition: state
    entity_id: binary_sensor.beschattung_zeitfenster
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.beschattung_westen_close
        state: 'on'
      sequence:
      - action: button.press
        metadata: {}
        data: {}
        target:
          entity_id: button.wohnzimmer_jalousie_my_position
      alias: Beschatten
    - conditions:
      - condition: numeric_state
        entity_id: cover.wohnzimmer_jalousie
        attribute: current_tilt_position
        above: 0
      - condition: numeric_state
        entity_id: sensor.wetterluxtotal
        below: 10000
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.wohnzimmer_jalousie
      alias: Öffnen
  mode: single
- id: '1750864984348'
  alias: Beschattung - UG - Hobby West
  description: ''
  triggers:
  - trigger: time_pattern
    minutes: /5
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: cover.hobby_west
      state: closed
    alias: Wenn Fenster nicht geschlossen ist
  - condition: state
    entity_id: binary_sensor.beschattung_zeitfenster
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: and
        conditions:
        - condition: state
          entity_id: binary_sensor.fenster_hobbyraum_west
          state: 'off'
        - condition: state
          entity_id: binary_sensor.beschattung_westen_close
          state: 'on'
      sequence:
      - action: button.press
        metadata: {}
        data: {}
        target:
          entity_id: button.hobby_west_my_position
      alias: Beschatten
    - conditions:
      - condition: numeric_state
        entity_id: cover.hobby_west
        attribute: current_position
        above: 0
      - condition: numeric_state
        entity_id: sensor.wetterluxtotal
        below: 1000
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.hobby_west_low_speed
      alias: Öffnen
  mode: single
- id: '1750865074285'
  alias: Beschattung - OG - Erik West
  description: ''
  triggers:
  - trigger: time_pattern
    minutes: /5
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: cover.erik_west
      state: closed
    alias: Wenn Fenster nicht geschlossen ist
  - condition: state
    entity_id: binary_sensor.beschattung_zeitfenster
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.beschattung_westen_close
        state: 'on'
      sequence:
      - action: button.press
        metadata: {}
        data: {}
        target:
          entity_id: button.erik_west_my_position
      alias: Beschatten
    - conditions:
      - condition: numeric_state
        entity_id: cover.erik_west
        attribute: current_position
        above: 0
      - condition: numeric_state
        entity_id: sensor.wetterluxtotal
        below: 1000
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.erik_west_low_speed
      alias: Öffnen
  mode: single
- id: '1750865139579'
  alias: Beschattung - OG - LiHe West
  description: ''
  triggers:
  - trigger: time_pattern
    minutes: /5
  conditions:
  - condition: not
    conditions:
    - condition: state
      entity_id: cover.linus_west
      state: closed
    alias: Wenn Fenster nicht geschlossen ist
  - condition: state
    entity_id: binary_sensor.beschattung_zeitfenster
    state: 'on'
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.beschattung_westen_close
        state: 'on'
      sequence:
      - action: button.press
        metadata: {}
        data: {}
        target:
          entity_id: button.linus_west_my_position
      alias: Beschatten
    - conditions:
      - condition: numeric_state
        entity_id: cover.linus_west
        attribute: current_position
        above: 0
      - condition: numeric_state
        entity_id: sensor.wetterluxtotal
        below: 1000
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.linus_west_low_speed
      alias: Öffnen
  mode: single
- id: '1752162128760'
  alias: Monitoring - Briefkasten
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.ads_briefkasten_full
    from: 'off'
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 0
    id: Belegt
  - trigger: state
    entity_id:
    - binary_sensor.ads_briefkasten_full
    from: 'on'
    to: 'off'
    for:
      hours: 0
      minutes: 0
      seconds: 0
    id: Frei
  conditions: []
  actions:
  - if:
    - condition: trigger
      id:
      - Belegt
    then:
    - action: notify.notification_group_all_devices
      metadata: {}
      data:
        message: Brief erhalten!
        title: POST
    - action: script.eink_display_eg_diele_licht
      metadata: {}
      data:
        modus: Briefkasten
  - if:
    - condition: trigger
      id:
      - Frei
    then:
    - action: script.eink_display_eg_diele_licht
      metadata: {}
      data:
        modus: aus
  mode: single
- id: '1752686838076'
  alias: EnergySave - Schreibtisch
  description: ''
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.std_schreibtisch_leistung
    for:
      hours: 0
      minutes: 15
      seconds: 0
    below: 5
  conditions:
  - condition: time
    after: '20:00:00'
    before: 06:00:00
  actions:
  - action: switch.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: switch.std_schreibtisch
  mode: single
